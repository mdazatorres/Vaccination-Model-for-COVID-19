# Vaccination-Model-for-COVID-19.

This repository contains the code and data to study vaccination scenarios for opening  California on June 15, 2021, using compartmental mathematical models and Bayesian analysis.



## Parameter estimation: Coverage vaccination model

### Data needed
- CA-Vaccine.xlsx
This file provides the vaccine information for California. It was updated on May 16, 2021. 
Data source https://data.ca.gov/dataset/covid-19-vaccine-progress-dashboard-data.

### To run
- MCMC_vaccine_coverage.py
This file contains the MCMC for estimation of the parameters for the coverage vaccination model.
 
#### Output
- Output_MCMC.pkl
- Figures 2S

### To visualize
- vaccine_coverage_model.py
To visualize the parameter estimation of the coverage vaccination model. This file read the output generated by MCMC_vaccine_coverage.py

#### Output
-  Figure 3S


## Parameter estimation: Transmission model

### Data needed
- CA.csv 
This file provides records of deaths and confirmed cases for California from January 13, 2020, to May 18, 2021.
- Info_data.csv 
This file contains the number population and initial date outbreak in California.

### To run
- Run_MCMCM.py
This file contains the MCMC for estimation of the parameters of the transmission model. 

#### Auxiliar files
In these files,  we define the transmission model and its numerical solution as well  the functions used for the mcmc for being called by Run_MCMCM.py and don't need to run.
- covid_fm.py
- fm_matrix.py 
- main_mcmc.py

#### Output
- *.csv files with the quantiles 80 and 50 for all forecast. 
-  *_samples.pkl  files with the MCMC simulation for the estimated parameters in each forecast.
- *_solns_plain.pkl files with the MCMC output of the trajectories for observed and deaths.

### To visualize

- plot_outbreak_CA.py,
#### Output:
Figure 4S

- plot_params_CA.py
#### Output:
Figure  5S


## Calibration of the coverage interval

### To run
- Calibration_forecasting.py
In this file, we compute the average of the coverage interval obtained for all forecasts. 
To run this file, you need the *.csv files generated for Run_MCMC.py

#### Output:
Table 1S


## Vaccine Scenarios

### Data needed
- CA.csv 
This file provides records of deaths and confirmed cases for California from January 13, 2020, to May 18, 2021.
- Info_data.csv 
This file contains the number population and initial date outbreak in California.

### To run
The next files contain the scenarios for the vaccination model when omega and beta are changed:
plot_table_w.py
plot_table_beta.py

#### Output
Figure 2

### To visualize
The next files produce a table with the vaccination scenarios when omega and beta are changed:
plot_vaccination_w.py
plot_vaccination_beta.py

#### Output
Table 3

### Needed files to run  previous files
- Output_MCMC.pkl :  This file is generated by MCMC_vaccine_coverage.py
-  CAcourt_*_samples.pkl : This file is generated byr Run_MCMC.py
-  CAcourt_*_solns_plain.pkl: This file is generated byr Run_MCMC.py


### Auxiliar files
In these files,  we define the vaccination model and its numerical solution and don't need to run.
- covid_fm_v.py
- fm_matriz_v.py


## Note
The MCMC use the t-walk implementation. https://www.cimat.mx/~jac/twalk/
- pytwalk.py
